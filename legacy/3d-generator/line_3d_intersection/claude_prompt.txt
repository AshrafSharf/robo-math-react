I need you to generate a render method for a 3d lesson named "line_3d_intersection".

## CRITICAL INSTRUCTION FILES TO READ FIRST

You MUST read ALL of these files in order before starting implementation:

### Core Files (MANDATORY):
1. Render method instructions: llm_generation/instructions/render-method-3d-instruction.txt
2. Shared patterns: llm_generation/instructions/shared-patterns.txt
3. Problem specification: src/line_3d_intersection/step-by-step.json
4. Reference implementation: src/direction_cosines/direction_cosines.js

### Critical Guidelines (MANDATORY - Read ALL that apply):
6. Testing procedures and Puppeteer usage: llm_generation/instructions/testing-procedures.md
7. CRITICAL testing checklist to prevent common errors: llm_generation/instructions/common-testing-oversights.md
8. Control panel design standards: llm_generation/instructions/control-panel-design.md
9. Calculation display rules (one equation per row): llm_generation/instructions/calculation-display-standards.md
10. CRITICAL rules for intermediate calculations: llm_generation/instructions/intermediate-calculations-guidelines.md
11. 3D utility functions and guidelines: llm_generation/instructions/common-utilities-3d.md
12. CRITICAL 3D visibility requirements: llm_generation/instructions/3d-visibility-requirements.md
13. MANDATORY coordinate transformation guidelines: llm_generation/instructions/threejs-coordinate-system-guidelines.md
14. Animation button styling and behavior: llm_generation/instructions/animation-button-standard.md
15. Three.js API reference: llm_generation/instructions/THREE_JS_API_REFERENCE.md
16. Image embedding in JSXGraph lessons: llm_generation/instructions/image-jsx-instructions.md

## COMPREHENSIVE IMPLEMENTATION CHECKLIST

You MUST complete this checklist in order. DO NOT skip any step. Check off each item as you complete it:

### Phase 1: Pre-Implementation Analysis
- [ ] Read ALL instruction files listed above (every single one that applies)
- [ ] Read and understand the problem specification completely
- [ ] **CRITICAL: If custom_instructions.txt exists, read it and follow ALL custom requirements**
- [ ] **CRITICAL: If visual.png exists, examine it carefully and note ALL visual elements**
- [ ] Examine any reference images provided
- [ ] Identify lesson type (2D, 3D, 3D-JSX, 2D+3D, 2D+2D, or 2-col-3-row) from meta.json
- [ ] Note if animation is required from meta.json
- [ ] Review reference implementation if provided
- [ ] Identify all inputs that need to be adjustable
- [ ] Identify the exact output requested in the problem
- [ ] Check step-by-step.json for any intermediate calculations to display

### Phase 2: Implementation Planning
- [ ] Determine appropriate bounding box for the visualization
- [ ] Plan control panel sections (inputs, calculations, result, instructions)
- [ ] Identify which common utility functions to use
- [ ] Plan any animations if required
- [ ] Consider coordinate transformations if 3D
- [ ] Plan color scheme using standard constants

### Phase 3: Core Implementation
- [ ] Create proper module structure with render() function
- [ ] Import all required utilities from common modules
- [ ] Store references for namespace isolation
- [ ] Set appropriate bounding box
- [ ] Create coordinate system with proper labels
- [ ] Implement all mathematical objects from the problem
- [ ] Add labels to ALL important elements (points, angles, vectors)
- [ ] Ensure ALL labels use black color (#000000)

### Phase 4: Control Panel Implementation
- [ ] Create control panel sections in correct order
- [ ] Add steppers/sliders for ALL adjustable parameters
- [ ] Check step-by-step.json for intermediate calculations
- [ ] Display ONLY calculations mentioned in step-by-step.json
- [ ] Ensure one equation per row (NEVER multiple on same line)
- [ ] Display the exact output requested in the problem
- [ ] Add ONE clear, single-line instruction at bottom
- [ ] Verify instruction is not cut off (test with Puppeteer)

### Phase 5: Visual Requirements Verification
- [ ] All text and labels are black (#000000)
- [ ] No colored text in diagrams
- [ ] Font sizes: 20-22px for labels, 16-18px for control panel
- [ ] Proper spacing between elements (no overlapping)
- [ ] Clean, professional appearance
- [ ] Animation controls present if required by meta.json
- [ ] For 3D: Use cylinders for lines (linewidth > 10)
- [ ] For 3D: Use spheres for points
- [ ] For 3D: Axis labels present (except solid_of_revolution)

### Phase 6: Interactive Features
- [ ] Implement update functions for dynamic content
- [ ] Add event handlers for user interactions
- [ ] Test dragging functionality
- [ ] Test stepper controls
- [ ] Test animation if present
- [ ] Verify immediate visual feedback

### Phase 7: Visual.png Verification (if visual.png exists)
- [ ] Compare point positions with visual.png
- [ ] Verify line directions match exactly
- [ ] Check vector arrow directions and positions
- [ ] **CRITICAL for angles**: Read angle-rendering-guidelines.md if lesson has angles
- [ ] Verify angle orientations match exactly (check quadrants and direction)
- [ ] Confirm all labels match the reference
- [ ] Check distance markers are positioned correctly
- [ ] If axes shown in visual.png, ensure they're rendered
- [ ] Verify overall figure orientation (not rotated/flipped)

### Phase 8: Testing - Development Mode
- [ ] Save the render method to src/line_3d_intersection/line_3d_intersection.js
- [ ] Run: ./lesson.sh dev line_3d_intersection
- [ ] Navigate to http://localhost:3001 with Puppeteer
- [ ] Check for JavaScript console errors
- [ ] **CRITICAL: Take screenshot and compare with visual.png**
- [ ] Verify all visual elements render correctly
- [ ] Test all interactive features
- [ ] Verify control panel elements are fully visible
- [ ] Ensure instructions at bottom are not cut off
- [ ] Take screenshot for verification
- [ ] Fix any errors found
- [ ] Re-test until no errors remain

### Phase 9: Testing - Standalone Build
- [ ] Build standalone: ./lesson.sh build line_3d_intersection
- [ ] Serve build directory with HTTP server
- [ ] Test standalone HTML file with Puppeteer
- [ ] Verify CDN resources load correctly
- [ ] Check for console errors
- [ ] Test all functionality
- [ ] Fix any issues found
- [ ] Re-test until perfect

### Phase 10: Final Verification
- [ ] Lesson implements the exact mathematical concept
- [ ] All inputs from problem are adjustable
- [ ] Output matches what problem asks to find
- [ ] Visual representation is clear and educational
- [ ] Interactive elements provide immediate feedback
- [ ] No JavaScript errors in console (dev or standalone)
- [ ] Control panel fully visible without scrolling
- [ ] Professional, polished appearance
- [ ] All instruction guidelines have been followed

## CRITICAL REMINDERS:
1. **VISUAL.PNG IS TRUTH** - If visual.png exists, your implementation MUST match it exactly
2. Testing is MANDATORY - use Puppeteer as described in testing-procedures.md
3. Check step-by-step.json BEFORE adding any calculations
4. For 3D lessons, ALWAYS transform coordinates properly
5. Common oversights are documented - read common-testing-oversights.md
6. One equation per row in calculations - NEVER side by side
6. ALL text must be black (#000000) - no exceptions

Only after ALL checkboxes above are checked can you report the lesson as complete and working.